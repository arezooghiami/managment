<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ú¯Ø²Ø§Ø±Ø´ ÙˆØ¶Ø¹ÛŒØª ØªÙ…Ø§Ø³â€ŒÙ‡Ø§</title>
  <!-- Google Font - Vazirmatn (Ù…Ù†Ø§Ø³Ø¨ ÙØ§Ø±Ø³ÛŒ Ùˆ Ù…ÛŒÙ†ÛŒÙ…Ø§Ù„) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css">
  <!-- Persian Datepicker -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/persian-datepicker@latest/dist/css/persian-datepicker.min.css">

  <style>
    :root {
      --primary-brown: #8B4513;      /* Ù‚Ù‡ÙˆÙ‡â€ŒØ§ÛŒ Ú¯Ø±Ù… - Ø±Ù†Ú¯ Ø§ØµÙ„ÛŒ Ú†Ø±Ù… Ù…Ø´Ù‡Ø¯ */
      --accent-gold: #D4AF37;        /* Ø·Ù„Ø§ÛŒÛŒ Ø´ÛŒÚ© */
      --light-brown: #D2B48C;        /* Ù‚Ù‡ÙˆÙ‡â€ŒØ§ÛŒ Ø±ÙˆØ´Ù† Ø¨Ø±Ø§ÛŒ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ */
      --bg-gray: #F8F5F2;            /* Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ø®ÛŒÙ„ÛŒ Ø±ÙˆØ´Ù† Ùˆ Ú¯Ø±Ù… */
      --card-bg: #FFFFFF;
      --text-dark: #3D2B1F;
      --border-color: #E8E0D8;
      --success-green: #2E8B57;
      --danger-red: #DC143C;
    }

    body {
      font-family: 'Vazirmatn', sans-serif;
      background-color: var(--bg-gray);
      color: var(--text-dark);
      margin: 0;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .card {
      background: var(--card-bg);
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(139, 69, 19, 0.08);
      padding: 32px;
      border: 1px solid var(--border-color);
    }

    .header-section {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      flex-wrap: wrap;
      gap: 16px;
    }

    h2 {
      color: var(--primary-brown);
      margin: 0;
      font-size: 28px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    h2::before {
      content: "ğŸ“Š";
      font-size: 32px;
    }

    .header-controls {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .today-date {
      background: var(--light-brown);
      color: var(--primary-brown);
      padding: 10px 16px;
      border-radius: 12px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn {
      padding: 10px 20px;
      border-radius: 12px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      border: none;
      display: flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
    }

    .btn-primary {
      background: var(--primary-brown);
      color: white;
    }

    .btn-primary:hover {
      background: #6D360F;
    }

    .btn-secondary {
      background: var(--light-brown);
      color: var(--primary-brown);
      border: 1px solid var(--border-color);
    }

    .btn-secondary:hover {
      background: #C9A87A;
    }

    .btn-print {
      background: var(--success-green);
      color: white;
    }

    .btn-print:hover {
      background: #247A48;
    }

    .filters {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 16px;
      margin-bottom: 32px;
      padding-bottom: 24px;
      border-bottom: 2px solid var(--border-color);
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .date-input-group {
      position: relative;
    }

    .calendar-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      color: var(--primary-brown);
    }

    label {
      font-size: 14px;
      color: var(--primary-brown);
      margin-bottom: 8px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    input[type="text"],
    select {
      padding: 12px 16px;
      border: 1px solid var(--border-color);
      border-radius: 12px;
      background: #fff;
      font-size: 16px;
      transition: border-color 0.3s, box-shadow 0.3s;
      width: 100%;
    }

    input[type="text"]:focus,
    select:focus {
      outline: none;
      border-color: var(--accent-gold);
      box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.15);
    }

    .date-input {
      padding-right: 40px !important;
      cursor: pointer;
    }

    .form-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 24px;
      gap: 16px;
    }

    .submit-btn {
      padding: 14px 28px;
      background: var(--primary-brown);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .submit-btn:hover {
      background: #6D360F;
    }

    .reset-btn {
      padding: 14px 28px;
      background: var(--light-brown);
      color: var(--primary-brown);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s;
    }

    .reset-btn:hover {
      background: #C9A87A;
    }

    @media (min-width: 768px) {
      .form-actions {
        justify-content: flex-start;
        gap: 16px;
      }
    }

    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin-top: 24px;
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }

    th {
      background: var(--light-brown);
      color: var(--primary-brown);
      padding: 16px;
      font-weight: 600;
      text-align: center;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    td {
      padding: 16px;
      text-align: center;
      border-bottom: 1px solid var(--border-color);
    }

    tr:last-child td {
      border-bottom: none;
    }

    tr:nth-child(even) {
      background-color: #FFF8F2;
    }

    tr:hover {
      background-color: rgba(212, 175, 55, 0.08);
    }

    .no-data {
      text-align: center;
      padding: 40px;
      color: #999;
      font-size: 18px;
    }

    @media print {
      .header-controls,
      .filters,
      .form-actions,
      .btn-print {
        display: none !important;
      }

      .card {
        box-shadow: none;
        border: 1px solid #ddd;
      }

      table {
        box-shadow: none;
      }

      th {
        background: #f2f2f2 !important;
        -webkit-print-color-adjust: exact;
        color-adjust: exact;
      }

      body {
        background: white;
        padding: 10px;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <div class="card">
    <!-- Ø¨Ø®Ø´ Ù‡Ø¯Ø± Ø¨Ø§ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ÛŒ -->
    <div class="header-section">
      <h2>Ú¯Ø²Ø§Ø±Ø´ ÙˆØ¶Ø¹ÛŒØª ØªÙ…Ø§Ø³â€ŒÙ‡Ø§</h2>

      <div class="header-controls">
        <div class="today-date">
          <span>ğŸ“…</span>
          <span id="todayDate">Ø§Ù…Ø±ÙˆØ²: Û±Û´Û°Û³/Û°Û±/Û°Û±</span>
        </div>

        <button class="btn btn-primary" onclick="window.history.back()">
          <span>â†¶</span>
          Ø¨Ø§Ø²Ú¯Ø´Øª
        </button>

        <button class="btn btn-print" onclick="window.print()">
          <span>ğŸ–¨ï¸</span>
          Ú†Ø§Ù¾ Ú¯Ø²Ø§Ø±Ø´
        </button>


      </div>
    </div>

    <!-- ÙØ±Ù… ÙÛŒÙ„ØªØ±Ù‡Ø§ -->
    <form id="reportForm" class="filters">
      <div class="filter-group">
        <label>ğŸ“… Ø§Ø² ØªØ§Ø±ÛŒØ®</label>
        <div class="date-input-group">
          <input type="text" name="start_date" id="start_date" class="date-input" placeholder="Û±Û´Û°Û³/Û°Û±/Û°Û±" required>
          <span class="calendar-icon" onclick="openDatepicker('start_date')">ğŸ“…</span>
        </div>
      </div>

      <div class="filter-group">
        <label>ğŸ“… ØªØ§ ØªØ§Ø±ÛŒØ®</label>
        <div class="date-input-group">
          <input type="text" name="end_date" id="end_date" class="date-input" placeholder="Û±Û´Û°Û³/Û°Û±/Û³Û°" required>
          <span class="calendar-icon" onclick="openDatepicker('end_date')">ğŸ“…</span>
        </div>
      </div>

      <div class="filter-group">
        <label>ğŸ” ÙˆØ¶Ø¹ÛŒØª</label>
        <select name="status">
          <option value="">Ù‡Ù…Ù‡ ÙˆØ¶Ø¹ÛŒØªâ€ŒÙ‡Ø§</option>
          <option value="1">Ø­Ù„ Ø´Ø¯Ù‡</option>
          <option value="2">Ù†ÛŒØ§Ø² Ø¨Ù‡ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ</option>
          <option value="3">Ø§Ø±Ø¬Ø§Ø¹ Ø´Ø¯Ù‡</option>
        </select>
      </div>

      <div class="filter-group">
        <label>ğŸ“‹ Ù…ÙˆØ¶ÙˆØ¹</label>
        <select name="topic">
          <option value="">Ù‡Ù…Ù‡ Ù…ÙˆØ¶ÙˆØ¹Ø§Øª</option>
          <option value="posty_code">Ø§Ø³ØªØ¹Ù„Ø§Ù… Ú©Ø¯ Ø±Ù‡Ú¯ÛŒØ±ÛŒ</option>
          <option value="send_product_deadline">Ù…Ù‡Ù„Øª Ø§Ø±Ø³Ø§Ù„ Ú©Ø§Ù„Ø§</option>
          <option value="branch_change">ØªØ¹ÙˆÛŒØ¶ Ùˆ Ù…Ø±Ø¬ÙˆØ¹ Ø´Ø¹Ø¨Ù‡</option>
          <option value="online_change">ØªØ¹ÙˆÛŒØ¶ Ø¢Ù†Ù„Ø§ÛŒÙ†</option>
          <option value="online_return">Ù…Ø±Ø¬ÙˆØ¹ Ø¢Ù†Ù„Ø§ÛŒÙ†</option>
          <option value="branch_dissatisfaction">Ù†Ø§Ø±Ø¶Ø§ÛŒØªÛŒ Ø§Ø² Ø´Ø¹Ø¨Ù‡</option>
          <option value="payment_followup">Ù¾ÛŒÚ¯ÛŒØ±ÛŒ ÙˆØ§Ø±ÛŒØ²ÛŒ</option>
          <option value="incomplete_delivery">Ø§Ø±Ø³Ø§Ù„ Ù†Ø§Ù‚Øµ</option>
          <option value="b2b_sales">ÙØ±ÙˆØ´ Ø³Ø§Ø²Ù…Ø§Ù†ÛŒ</option>
          <option value="waiting_for_payment">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± Ù¾Ø±Ø¯Ø§Ø®Øª</option>
          <option value="product_search">Ø³Ø±Ú† Ú©Ø§Ù„Ø§</option>
          <option value="after_sales_service">Ø®Ø¯Ù…Ø§Øª Ù¾Ø³ Ø§Ø² ÙØ±ÙˆØ´</option>
          <option value="club">Ø¨Ø§Ø´Ú¯Ø§Ù‡</option>
          <option value="other">Ù…ØªÙØ±Ù‚Ù‡</option>
          <option value="branch_info">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ø¹Ø¨</option>
          <option value="product_site_info">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³Ø§ÛŒØª Ùˆ Ù…Ø­ØµÙˆÙ„</option>
          <option value="snapp_pay">Ø§Ø³Ù†Ù¾â€ŒÙ¾ÛŒ</option>
          <option value="inner_call">Ø¯Ø§Ø®Ù„ÛŒ</option>
          <option value="defective_product">Ú©Ø§Ù„Ø§ÛŒ Ø§ÛŒØ±Ø§Ø¯ Ø¯Ø§Ø±</option>
        </select>
      </div>

      <div class="filter-group">
        <label>ğŸ‘¤ Ø§Ù¾Ø±Ø§ØªÙˆØ±</label>
        <select name="user_id">
          <option value="">Ù‡Ù…Ù‡ Ø§Ù¾Ø±Ø§ØªÙˆØ±Ù‡Ø§</option>
          {% for user in users %}
          <option value="{{ user.id }}">{{ user.name }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="form-actions">
        <button type="submit" class="submit-btn">
          <span>ğŸ“ˆ</span>
          Ø¯Ø±ÛŒØ§ÙØª Ú¯Ø²Ø§Ø±Ø´
        </button>
        <button type="button" class="reset-btn" onclick="resetForm()">
          <span>ğŸ”„</span>
          Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ ÙÛŒÙ„ØªØ±Ù‡Ø§
        </button>
      </div>
    </form>

    <!-- Ø¬Ø¯ÙˆÙ„ Ù†ØªØ§ÛŒØ¬ -->
    <table id="resultTable">
      <thead>
      <tr>
        <th>Ù…ÙˆØ¶ÙˆØ¹</th>
        <th>ÙˆØ¶Ø¹ÛŒØª</th>

        <th>ØªØ¹Ø¯Ø§Ø¯</th>
        <th>Ø¯Ø±ØµØ¯</th>
      </tr>
      </thead>
      <tbody>
      <!-- Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ø¬Ø§ÙˆØ§Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù¾Ø± Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
      </tbody>
    </table>

    <div id="noData" class="no-data" style="display: none;">Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.</div>
  </div>
</div>

<!-- Persian Datepicker -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/persian-date@latest/dist/persian-date.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/persian-datepicker@latest/dist/js/persian-datepicker.min.js"></script>

<script>
  // ØªÙ†Ø¸ÛŒÙ… ØªØ§Ø±ÛŒØ® Ø§Ù…Ø±ÙˆØ²
  document.addEventListener('DOMContentLoaded', function() {
    const today = new persianDate().toLocale('fa').format('YYYY/MM/DD');
    document.getElementById('todayDate').textContent = `Ø§Ù…Ø±ÙˆØ²: ${today}`;

    // ØªÙ†Ø¸ÛŒÙ… ØªØ§Ø±ÛŒØ® Ù¾ÛŒØ´â€ŒÙØ±Ø¶ (Ù…Ø§Ù‡ Ø¬Ø§Ø±ÛŒ)
    const startOfMonth = new persianDate().startOf('month').toLocale('fa').format('YYYY/MM/DD');
    const endOfMonth = new persianDate().endOf('month').toLocale('fa').format('YYYY/MM/DD');

    document.getElementById('start_date').value = startOfMonth;
    document.getElementById('end_date').value = endOfMonth;

    // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ datepicker
    $(".date-input").persianDatepicker({
      format: 'YYYY/MM/DD',
      autoClose: true,
      initialValue: false,
      observer: true,
      position: "auto",
    });
  });

  // ØªØ§Ø¨Ø¹ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† datepicker
  function openDatepicker(inputId) {
    $(`#${inputId}`).focus();
  }

  // ØªØ§Ø¨Ø¹ Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ ÙØ±Ù…
  function resetForm() {
    document.getElementById('reportForm').reset();
    const startOfMonth = new persianDate().startOf('month').toLocale('fa').format('YYYY/MM/DD');
    const endOfMonth = new persianDate().endOf('month').toLocale('fa').format('YYYY/MM/DD');

    document.getElementById('start_date').value = startOfMonth;
    document.getElementById('end_date').value = endOfMonth;
  }

  // Ø§Ø±Ø³Ø§Ù„ ÙØ±Ù… Ùˆ Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
  document.getElementById("reportForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    const params = new URLSearchParams();
    for (const [key, value] of new FormData(this)) {
      if (value !== "") {
        params.append(key, value);
      }
    }

    try {
      const res = await fetch("/reports/calls?" + params.toString());
      const data = await res.json();

      const tbody = document.querySelector("#resultTable tbody");
      const noDataMsg = document.getElementById("noData");

      tbody.innerHTML = "";

      if (data.length === 0) {
        noDataMsg.style.display = "block";
        document.querySelector("#resultTable").style.display = "none";
      } else {
        noDataMsg.style.display = "none";
        document.querySelector("#resultTable").style.display = "table";

        // ØªØ¨Ø¯ÛŒÙ„ Ú©Ø¯ ÙˆØ¶Ø¹ÛŒØª Ø¨Ù‡ Ù…ØªÙ†
        const statusMap = {
          "1": "Ø­Ù„ Ø´Ø¯Ù‡",
          "2": "Ù†ÛŒØ§Ø² Ø¨Ù‡ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ",
          "3": "Ø§Ø±Ø¬Ø§Ø¹ Ø´Ø¯Ù‡"
        };

        // ØªØ¨Ø¯ÛŒÙ„ Ú©Ø¯ Ù…ÙˆØ¶ÙˆØ¹ Ø¨Ù‡ Ù…ØªÙ† ÙØ§Ø±Ø³ÛŒ
        const topicMap = {
          "posty_code": "Ø§Ø³ØªØ¹Ù„Ø§Ù… Ú©Ø¯ Ø±Ù‡Ú¯ÛŒØ±ÛŒ",
          "send_product_deadline": "Ù…Ù‡Ù„Øª Ø§Ø±Ø³Ø§Ù„ Ú©Ø§Ù„Ø§",
          "branch_change": "ØªØ¹ÙˆÛŒØ¶ Ùˆ Ù…Ø±Ø¬ÙˆØ¹ Ø´Ø¹Ø¨Ù‡",
          "online_change": "ØªØ¹ÙˆÛŒØ¶ Ø¢Ù†Ù„Ø§ÛŒÙ†",
          "online_return": "Ù…Ø±Ø¬ÙˆØ¹ Ø¢Ù†Ù„Ø§ÛŒÙ†",
          "branch_dissatisfaction": "Ù†Ø§Ø±Ø¶Ø§ÛŒØªÛŒ Ø§Ø² Ø´Ø¹Ø¨Ù‡",
          "payment_followup": "Ù¾ÛŒÚ¯ÛŒØ±ÛŒ ÙˆØ§Ø±ÛŒØ²ÛŒ",
          "incomplete_delivery": "Ø§Ø±Ø³Ø§Ù„ Ù†Ø§Ù‚Øµ",
          "b2b_sales": "ÙØ±ÙˆØ´ Ø³Ø§Ø²Ù…Ø§Ù†ÛŒ",
          "waiting_for_payment": "Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± Ù¾Ø±Ø¯Ø§Ø®Øª",
          "product_search": "Ø³Ø±Ú† Ú©Ø§Ù„Ø§",
          "after_sales_service": "Ø®Ø¯Ù…Ø§Øª Ù¾Ø³ Ø§Ø² ÙØ±ÙˆØ´",
          "club": "Ø¨Ø§Ø´Ú¯Ø§Ù‡",
          "other": "Ù…ØªÙØ±Ù‚Ù‡",
          "branch_info": "Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ø¹Ø¨",
          "product_site_info": "Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³Ø§ÛŒØª Ùˆ Ù…Ø­ØµÙˆÙ„",
          "snapp_pay": "Ø§Ø³Ù†Ù¾â€ŒÙ¾ÛŒ",
          "inner_call": "Ø¯Ø§Ø®Ù„ÛŒ",
          "defective_product": "Ú©Ø§Ù„Ø§ÛŒ Ø§ÛŒØ±Ø§Ø¯ Ø¯Ø§Ø±"
        };

        // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ú©Ù„ ØªÙ…Ø§Ø³â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ØµØ¯
        let totalCalls = 0;
        data.forEach(row => {
          totalCalls += parseInt(row.count);
        });

        // Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Ø¬Ø¯ÙˆÙ„
        data.forEach(row => {
          const topicText = topicMap[row.topic] || row.topic;
          const statusText = statusMap[row.status] || row.status;
          const percentage = totalCalls > 0 ? ((row.count / totalCalls) * 100).toFixed(1) : 0;

          tbody.innerHTML += `
            <tr>
              <td>${topicText}</td>
              <td>${statusText}</td>

              <td>${parseInt(row.count).toLocaleString()}</td>
              <td>${percentage}%</td>
            </tr>
          `;
        });
      }
    } catch (err) {
      alert("Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.");
      console.error(err);
    }
  });

  // ØªØ§Ø¨Ø¹ Ú†Ø§Ù¾ Ú¯Ø²Ø§Ø±Ø´
  window.addEventListener('beforeprint', function() {
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø¶Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ Ú†Ø§Ù¾
    const printHeader = `
      <div style="text-align: center; margin-bottom: 20px; border-bottom: 2px solid #8B4513; padding-bottom: 10px;">
        <h1 style="color: #8B4513; margin: 0;">Ú¯Ø²Ø§Ø±Ø´ ÙˆØ¶Ø¹ÛŒØª ØªÙ…Ø§Ø³â€ŒÙ‡Ø§</h1>
        <p style="color: #666;">ØªØ§Ø±ÛŒØ® ØªÙ‡ÛŒÙ‡ Ú¯Ø²Ø§Ø±Ø´: ${new persianDate().toLocale('fa').format('YYYY/MM/DD HH:mm')}</p>
        <p style="color: #666;">Ø¨Ø§Ø²Ù‡ Ø²Ù…Ø§Ù†ÛŒ: ${document.getElementById('start_date').value} ØªØ§ ${document.getElementById('end_date').value}</p>
      </div>
    `;

    document.querySelector('.card').insertAdjacentHTML('afterbegin', printHeader);
  });

  window.addEventListener('afterprint', function() {
    // Ø­Ø°Ù Ù‡Ø¯Ø± Ú†Ø§Ù¾ Ø¨Ø¹Ø¯ Ø§Ø² Ø§ØªÙ…Ø§Ù… Ú†Ø§Ù¾
    const printHeader = document.querySelector('.card > div:first-child');
    if (printHeader && printHeader.querySelector('h1')) {
      printHeader.remove();
    }
  });
</script>

</body>
</html>