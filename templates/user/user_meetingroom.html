<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8"/>
  <title>داشبورد پرسنل | چرم مشهد</title>

  <!-- Bootstrap RTL CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Persian Datepicker CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/persian-datepicker@1.2.0/dist/css/persian-datepicker.min.css">

  <style>
    :root {
      --primary-leather: #3d0c02;
      --secondary-leather: #6b1f12;
      --accent-leather: #d9b38c;
      --light-leather: #f5e7d9;
      --dark-leather: #2a0802;
    }

    body {
      font-family: "IRANSans", "Segoe UI", Tahoma, sans-serif;
      background: linear-gradient(135deg, #f8f4f0 0%, #f0e6d8 100%);
      background-attachment: fixed;
      color: #333;
      padding-bottom: 50px;
    }

    .leather-texture {
      background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23d9b38c' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
      background-color: var(--light-leather);
    }

    .navbar {
      background: linear-gradient(to right, var(--dark-leather), var(--primary-leather));
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      padding: 12px 0;
      border-bottom: 3px solid var(--accent-leather);
    }

    .navbar-brand {
      font-weight: 700;
      font-size: 1.4rem;
      letter-spacing: -0.5px;
      display: flex;
      align-items: center;
    }

    .navbar-brand i {
      margin-left: 10px;
      color: var(--accent-leather);
      background: rgba(255, 255, 255, 0.1);
      padding: 8px;
      border-radius: 50%;
    }

    .navbar-text {
      font-size: 1.1rem;
      background: rgba(255, 255, 255, 0.15);
      padding: 5px 15px;
      border-radius: 20px;
      font-weight: 500;
    }

    .container-main {
      max-width: 1200px;
      margin: 30px auto;
      padding: 0 20px;
    }

    .page-header {
      text-align: center;
      margin-bottom: 30px;
      position: relative;
    }

    .page-header h1 {
      font-weight: 700;
      color: var(--primary-leather);
      position: relative;
      display: inline-block;
      padding-bottom: 15px;
    }

    .page-header h1:after {
      content: '';
      position: absolute;
      bottom: 0;
      right: 50%;
      transform: translateX(50%);
      width: 100px;
      height: 4px;
      background: var(--accent-leather);
      border-radius: 2px;
    }

    .card {
      border: none;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
      margin-bottom: 25px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      background: white;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    }

    .card-header {
      background: linear-gradient(to right, var(--primary-leather), var(--secondary-leather));
      color: white;
      font-weight: 600;
      font-size: 1.1rem;
      padding: 15px 20px;
      border-bottom: 2px solid var(--accent-leather);
    }

    .card-body {
      padding: 25px;
    }

    .section-title {
      color: var(--primary-leather);
      font-weight: 600;
      font-size: 1.05rem;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
    }

    .section-title i {
      margin-left: 8px;
      color: var(--accent-leather);
    }

    .btn-custom {

      border: none;
      border-radius: 8px;
      padding: 10px 25px;
      font-weight: 500;
      transition: all 0.3s ease;
      box-shadow: 0 3px 8px rgba(107, 31, 18, 0.2);
      position: relative;
      overflow: hidden;
    }

    .btn-custom:before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: 0.5s;
    }

    .btn-custom:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(107, 31, 18, 0.3);
    }

    .btn-custom:hover:before {
      left: 100%;
    }

    .btn-outline-custom {
      border: 2px solid var(--secondary-leather);
      color: var(--secondary-leather);
      font-weight: 500;
      border-radius: 8px;
      padding: 8px 20px;
      transition: all 0.3s ease;
    }

    .btn-outline-custom:hover {
      background: var(--secondary-leather);
      color: white;
    }

    .form-control, .form-select {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 10px 15px;
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
      transition: border-color 0.3s, box-shadow 0.3s;
    }

    .form-control:focus, .form-select:focus {
      border-color: var(--accent-leather);
      box-shadow: 0 0 0 0.25rem rgba(217, 179, 140, 0.25);
    }

    .form-label {
      font-weight: 500;
      color: #555;
      margin-bottom: 8px;
    }

    .form-check-input:checked {
      background-color: var(--secondary-leather);
      border-color: var(--secondary-leather);
    }

    .table {
      border-radius: 8px;
      overflow: hidden;
    }

    .table th {
      background: linear-gradient(to right, var(--primary-leather), var(--secondary-leather));
      color: white;
      font-weight: 500;
    }

    .table-striped>tbody>tr:nth-of-type(odd)>* {
      background-color: rgba(217, 179, 140, 0.08);
    }

    .alert {
      border-radius: 8px;
      padding: 12px 20px;
    }

    .border-custom {
      border: 1px solid rgba(217, 179, 140, 0.4);
      border-radius: 10px;
      padding: 20px;
      background: white;
      margin-bottom: 20px;
    }

    .leather-stamp {
      position: absolute;
      top: -25px;
      left: 20px;
      background: var(--accent-leather);
      color: var(--primary-leather);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      z-index: 10;
    }

    .leather-pattern {
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23d9b38c' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    }

    footer {
      background: linear-gradient(to right, var(--dark-leather), var(--primary-leather));
      color: white;
      padding: 20px 0;
      text-align: center;
      margin-top: 50px;
      border-top: 3px solid var(--accent-leather);
      font-size: 0.9rem;
    }

    .stat-card {
      text-align: center;
      padding: 20px;
      border-radius: 10px;
      background: white;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }

    .stat-card i {
      font-size: 2rem;
      color: var(--accent-leather);
      margin-bottom: 15px;
    }

    .stat-card h3 {
      color: var(--primary-leather);
      font-weight: 700;
      margin-bottom: 5px;
    }

    .stat-card p {
      color: #666;
      margin-bottom: 0;
    }

    .divider {
      height: 1px;
      background: linear-gradient(to right, transparent, var(--accent-leather), transparent);
      margin: 25px 0;
    }

    .logo-text {
      font-family: 'Georgia', serif;
      font-weight: bold;
      color: var(--primary-leather);
      text-shadow: 1px 1px 1px rgba(0,0,0,0.1);
      letter-spacing: 1px;
    }

    .leather-border {
      border: 8px solid transparent;
      border-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='75' height='75' viewBox='0 0 75 75'%3E%3Cpath fill='none' stroke='%23d9b38c' stroke-width='2' d='M1 1h73v73H1z'/%3E%3C/svg%3E") 8 stretch;
      border-radius: 4px;
    }
  </style>
</head>

<body class="leather-texture">
<nav class="navbar navbar-expand-lg">
  <div class="container">
    <a class="navbar-brand" href="#">
      <i class="fas fa-hands-helping"></i>
      <span class="logo-text">پرتال پرسنل چرم مشهد</span>
    </a>
    <div class="navbar-text">
      <i class="fas fa-calendar-alt me-2"></i>
      {{ today.strftime('%Y/%m/%d') }}
    </div>
  </div>
</nav>

<div class="container container-main">
  <div class="page-header">
    <h1>داشبورد مدیریت پرسنل</h1>
    <p class="text-muted">به پورتال اختصاصی کارکنان شرکت چرم مشهد خوش آمدید</p>
  </div>


  <div class="row">
  <div class="col-lg-6">
    <!-- رزرو اتاق جلسه -->
    <div class="card h-100">
      <div class="card-header">
        <i class="fas fa-calendar-alt me-2"></i>
        رزرو اتاق جلسه
      </div>
      <div class="card-body">
        <form method="post" action="/reserve_meeting" class="row g-3" onsubmit="return checkForm()">
          {% if request.session.get("error_message") %}
          <div class="alert alert-danger" role="alert">
            <i class="fas fa-exclamation-circle me-2"></i>
            {{ request.session.get("error_message") }}
            {% set _ = request.session.pop("error_message") %}
          </div>
          {% endif %}
          <input type="hidden" name="user_id" value="{{ user.id }}">

          <div class="col-md-6">
            <label class="form-label">تاریخ جلسه</label>
            <input type="text" name="reservation_date" class="form-control" placeholder="مثلاً: 1404/04/30" required>
            <small class="form-text text-muted">تاریخ را به فرمت شمسی وارد کنید: 1404/04/30</small>
          </div>
          <div class="col-md-3">
            <label class="form-label">از ساعت</label>
            <input type="time" name="start_time" class="form-control" required>
          </div>
          <div class="col-md-3">
            <label class="form-label">تا ساعت</label>
            <input type="time" name="end_time" class="form-control" required>
          </div>
          <label for="meeting_room_id">انتخاب اتاق جلسه:</label>
          <select name="selected_room" id="meeting_room_id">
            {% for room in meeting_rooms %}
            <option value="{{ room.id }}">{{ room.name }}</option>
            {% endfor %}
          </select>
          <div class="col-md-6">
            <label class="form-label">تعداد شرکت‌کنندگان</label>
            <input type="number" name="participants" class="form-control" required min="1">
          </div>
          <div class="col-md-6">
            <label class="form-label">موضوع جلسه</label>
            <input type="text" name="subject" class="form-control" required>
          </div>
          <div class="col-12 text-center mt-3">
            <button class="btn btn-custom px-4">
              <i class="fas fa-check-circle me-2"></i>
              رزرو جلسه
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="col-lg-6">
    <!-- جلسات امروز -->
    <div class="card h-100">
      <div class="card-header">
        <i class="fas fa-list me-2"></i>
        جلسات برنامه‌ریزی شده
      </div>
      <div class="card-body">
        {% if meetings %}
        <div class="table-responsive">
          <table class="table table-hover">
            <thead>
            <tr>
              <th>ساعت</th>
              <th>رزرو شده توسط</th>
              <th>تاریخ</th>
              <th>عملیات</th>
            </tr>
            </thead>
            <tbody>
            {% for meeting in meetings %}
            <tr>
              <td>{{ meeting.start_time }} - {{ meeting.end_time }}</td>
              <td>{{ meeting.user.family }}</td>
              <td>{{ meeting.reservation_date }}</td>
              <td>
                {% if meeting.user.id == user.id %}
                <form method="post" action="/delete_meeting" onsubmit="return confirm('آیا از حذف جلسه اطمینان دارید؟');">
                  <input type="hidden" name="meeting_id" value="{{ meeting.id }}">
                  <input type="hidden" name="user_id" value="{{ user.id }}">
                  <button type="submit" class="btn btn-sm btn-danger">
                    <i class="fas fa-trash-alt"></i>
                  </button>
                </form>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
            </tbody>
          </table>
        </div>
        {% else %}
        <div class="text-center py-4">
          <i class="fas fa-calendar-times fa-3x text-muted mb-3"></i>
          <p class="text-muted">برای امروز جلسه‌ای ثبت نشده است.</p>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>

  <form action="/user_dashboard" method="GET" class="d-inline">
    <input type="hidden" name="user_id" value="{{ user.id }}">
    <button type="submit" class="btn btn-custom btn-sm" aria-label="بازگشت به داشبورد">
      <i class="fas fa-arrow-right me-2"></i> بازگشت
    </button>
  </form>
</div>

<footer>
  <div class="container">
    <div class="row">
      <div class="col-md-6 text-md-start">
        <p>تمامی حقوق برای شرکت چرم مشهد محفوظ می‌باشد © ۱۴۰۳</p>
      </div>
      <div class="col-md-6 text-md-end">
        <p>پشتیبانی: داخلی ۱۱۱ | <i class="fas fa-phone me-1"></i> ۰۵۱-۳۸۴۵۱۲۳۴</p>
      </div>
    </div>
  </div>
</footer>

<script>
  let guestIndex = 0;

  function addGuestForm() {
    guestIndex++;

    const container = document.getElementById("guest-forms-container");

    const guestForm = document.createElement("div");
    guestForm.classList.add("card", "mb-4", "leather-pattern");

    const headerDiv = document.createElement("div");
    headerDiv.classList.add("card-header", "py-3");
    headerDiv.innerHTML = `<i class="fas fa-user me-2"></i> اطلاعات مهمان`;

    guestForm.appendChild(headerDiv);

    const bodyDiv = document.createElement("div");
    bodyDiv.classList.add("card-body");



    guestForm.appendChild(bodyDiv);
    container.appendChild(guestForm);

    // Scroll to the new form
    guestForm.scrollIntoView({behavior: "smooth"});
  }
</script>
</body>
</html>